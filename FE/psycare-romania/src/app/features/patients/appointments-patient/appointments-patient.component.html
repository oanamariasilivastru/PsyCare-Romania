<mat-toolbar color="primary" class="menu-toolbar">
  <span class="logo" routerLink="/dashboard/patient">PsyCare</span>

  <div class="menu-buttons">
    <button mat-button routerLink="/dashboard/patient" routerLinkActive="active-button" [routerLinkActiveOptions]="{exact: true}">
      <mat-icon>dashboard</mat-icon>
      Dashboard
    </button>
    <button mat-button routerLink="/appointments/patient" routerLinkActive="active-button">
      <mat-icon>event</mat-icon>
      Appointments
    </button>
    <button mat-button routerLink="/tests/patient" routerLinkActive="active-button">
      <mat-icon>assignment</mat-icon>
      Tests
    </button>
    <button
      mat-button
      routerLink="/messages/patient"
      [matBadge]="unreadMessages"
      [matBadgeHidden]="unreadMessages === 0"
      matBadgeColor="warn"
    >
      <mat-icon>mail</mat-icon>
      Messages
    </button>
  </div>

  <span class="spacer"></span>

  <div class="menu-right">
    <button 
      mat-icon-button 
      [matBadge]="notificationsCount" 
      [matBadgeHidden]="notificationsCount === 0"
      matBadgeColor="warn"
    >
      <mat-icon>notifications</mat-icon>
    </button>

    <button mat-button [matMenuTriggerFor]="menu" class="user-button">
      <mat-icon>account_circle</mat-icon>
      <span class="user-name">{{ userName }}</span>
    </button>

    <mat-menu #menu="matMenu">
      <button mat-menu-item routerLink="/settings">
        <mat-icon>settings</mat-icon>
        <span>Settings</span>
      </button>
      <button mat-menu-item (click)="logout()">
        <mat-icon>logout</mat-icon>
        <span>Logout</span>
      </button>
    </mat-menu>
  </div>
</mat-toolbar>

<div class="appointments-container">
  <div class="page-header">
    <h1>My Appointments</h1>
    <p>View and manage your upcoming therapy sessions</p>
  </div>

  <div *ngIf="loading" class="loading-state">
    <mat-spinner diameter="50"></mat-spinner>
    <p>Loading appointments...</p>
  </div>

  <div *ngIf="!loading && appointments.length === 0" class="empty-state">
    <mat-icon>event_busy</mat-icon>
    <h3>No upcoming appointments</h3>
    <p>You don't have any scheduled appointments yet.</p>
    <button mat-raised-button color="primary" class="book-button">
      <mat-icon>add</mat-icon>
      Book an Appointment
    </button>
  </div>

  <div *ngIf="!loading && appointments.length > 0" class="appointments-list">
    <mat-card *ngFor="let app of appointments" class="appointment-card">
      <mat-card-header>
        <div class="appointment-icon" [style.background-color]="getAppointmentColor(app.date)">
          <mat-icon>event</mat-icon>
        </div>
        <div class="header-content">
          <mat-card-title>Session with {{ app.psychologistName }}</mat-card-title>
          <mat-card-subtitle>
            <mat-icon>schedule</mat-icon>
            {{ formatDate(app.date) }}
          </mat-card-subtitle>
        </div>
      </mat-card-header>
      
      <mat-card-content>
        <div class="appointment-details">
          <div class="detail-item">
            <mat-icon>person</mat-icon>
            <span>{{ app.psychologistName }}</span>
          </div>
          <div class="detail-item">
            <mat-icon>payments</mat-icon>
            <span>{{ app.fee }} RON</span>
          </div>
          <div class="detail-item" *ngIf="app.notes">
            <mat-icon>notes</mat-icon>
            <span>{{ app.notes }}</span>
          </div>
        </div>

        <div class="appointment-status" [class.upcoming]="isUpcoming(app.date)">
          <mat-icon>{{ isUpcoming(app.date) ? 'schedule' : 'check_circle' }}</mat-icon>
          <span>{{ isUpcoming(app.date) ? 'Upcoming' : 'Scheduled' }}</span>
        </div>
      </mat-card-content>

      <mat-card-actions>
        <button mat-button color="primary">
          <mat-icon>edit</mat-icon>
          Reschedule
        </button>
        <button mat-button color="warn">
          <mat-icon>cancel</mat-icon>
          Cancel
        </button>
      </mat-card-actions>
    </mat-card>
  </div>
</div>